
{extend name="public/base"} {block name="content"}
<section id="main-content">
    <section class="wrapper">
        <!--面包屑导航 BEGIN-->
        <ul class="breadcrumb">
            <li><a href="index.html"><i class="icon-home"><img style="width:12px;margin-top: -3px" src="__STATIC__/admin/img/sy.png" alt=""></i> 首页</a></li>
            <li><a href="javascript:;" id="parent_menu">前台财务管理</a></li>
            <li class="active" id="son_menu">提现明细</li>
        </ul>
        <!--面包屑导航 END-->

        <!--操作说明 BEGIN-->
        <div class="alert alert-success alert-block fade in">
            <button data-dismiss="alert" class="close close-sm" type="button">
                <i class="icon-remove"><img style="width:20px" src="__STATIC__/admin/img/cuo.png" alt=""></i>
            </button>
            <h4>
                <i class="icon-ok-sign"><img style="width:12px;margin-top: -3px" src="__STATIC__/admin/img/dh.png" alt=""></i>
                操作说明！
            </h4>
            <p>会员的财务明细</p>
        </div>
        <!--操作说明 END-->

        <!--搜索区域 BEGIN-->
        <div class="demoTable">
            <form style="display: inline" id="search">
                <div class="layui-inline">
                    <label class="layui-form-label">日期</label>
                    <div class="layui-input-inline">
                        <input type="text" class="layui-input" name="ub_create_time" id="testaa" lay-key="1" data-date="date" value="{$date}">
                    </div>
                </div>
                <span style="margin:0 2rem"></span>
                <span><div style="display: inline-block;margin-top: 0.2rem">搜索账号：
                    <div class="layui-inline">
                    <input class="layui-input" name="u_name" id=""  data-userid="userid" value="{$userid}">
                    </div><span style="margin:0 2rem"></span></div></span>
            </form>
            <button class="layui-btn" data-type="search">搜索</button>
            <button class="layui-btn" data-type="clear">清空</button>
        </div>
        <!--搜索区域 END-->

        <!--表格主体 BEGIN-->
        <table class="layui-hide" id="test" lay-filter="test1"></table>
        <div class=" layui-border-box layui-table-view" lay-filter="LAY-table-2" lay-id="test" >
            <div class="layui-table-box">
                <div class="layui-table-body">
                    <table cellspacing="0" cellpadding="0" border="0" class="layui-table" style="width:100%">
                        <thead>
                        <tr>
                            <th data-field="ub_id" data-key="2-0-0" class=" layui-unselect">
                                <div class="layui-table-cell laytable-cell-2-0-0">
                                    <span>ID</span>
                                    <span class="layui-table-sort layui-inline"></span>
                                </div>
                            </th>
                            <th data-field="u_name" data-key="2-0-1" class="">
                                <div class="layui-table-cell laytable-cell-2-0-1">
                                    <span>用户名</span>
                                </div>
                            </th>
                            <th data-field="u_name" data-key="2-0-1" class="">
                                <div class="layui-table-cell laytable-cell-2-0-1">
                                    <span>姓名</span>
                                </div>
                            </th>
                            <th data-field="u_name" data-key="2-0-1" class="">
                                <div class="layui-table-cell laytable-cell-2-0-1">
                                    <span>提现地址</span>
                                </div>
                            </th>
                            <th data-field="ub_money" data-key="2-0-2" class="">
                                <div class="layui-table-cell laytable-cell-2-0-2">
                                    <span>提现金额</span>
                                </div>
                            </th>
                            <th data-field="ub_create_time" data-key="2-0-7" class=" layui-unselect">
                                <div class="layui-table-cell laytable-cell-2-0-7"><span>时间</span></span></div>
                            </th>
                            <th data-field="ub_create_time" data-key="2-0-7" class=" layui-unselect">
                                <div class="layui-table-cell laytable-cell-2-0-7"><span>操作</span></span></div>
                            </th>
<!--                            <th data-field="ub_msg" data-key="2-0-8" class="">-->
<!--                                <div class="layui-table-cell laytable-cell-2-0-8"><span>备注</span></div>-->
<!--                            </th>-->
                        </tr>
                        </thead>

                        <tbody>
                        {volist name="money3" id="vo"}
                        <tr data-index="1" class="">
                            <td data-field="ub_id" data-key="2-0-0" class=""><div class="layui-table-cell laytable-cell-2-0-0">{$vo.id}</div></td>
                            <td data-field="u_name" data-key="2-0-1" class=""><div class="layui-table-cell laytable-cell-2-0-1">{$vo.userid}</div></td>
                            <td data-field="u_name" data-key="2-0-1" class=""><div class="layui-table-cell laytable-cell-2-0-1">{$vo.name}</div></td>
                            <td data-field="u_name" data-key="2-0-1" class=""><div class="layui-table-cell laytable-cell-2-0-1">{$vo.address}</div></td>
                            <td data-field="ub_money" data-key="2-0-2" class=""><div class="layui-table-cell laytable-cell-2-0-2">{$vo.money}</div></td>
                            <td data-field="ub_create_time" data-key="2-0-7" class=""><div class="layui-table-cell laytable-cell-2-0-7">{$vo.create_time}</div></td>
                            <td data-field="u_level " data-key="2-0-9 "class=" ">
                                <div class="layui-table-cell laytable-cell-2-0-9 ">
                                    {if $vo.type <=0}
                                    <span style="pointer-events: auto; cursor: pointer; " class="label label-success label-mini " onclick="queren('{$vo.id}')"> 确认</span>
                                    <span style="pointer-events: auto; cursor: pointer; " class="label label-danger label-mini " onclick="bohui('{$vo.id}')"> 驳回</span>
                                    {else}
                                    <span style="pointer-events: auto; cursor: pointer; " class="label label-success label-mini " >已处理</span>
                                    {/if}
                                </div>
                            </td>

                        </tr>
                        {/volist}
                        </tbody>
                    </table>
                </div>
            </div>
            {$money3->render()}

            <style>
                .laytable-cell-2-0-0{ width: 100px; }
                /* .laytable-cell-2-0-1{  }
                .laytable-cell-2-0-2{  }
                .laytable-cell-2-0-3{  }
                .laytable-cell-2-0-4{  }
                .laytable-cell-2-0-5{  } */
                .laytable-cell-2-0-6{ width: 100px; }
                /* .laytable-cell-2-0-7{  }
                .laytable-cell-2-0-8{  } */
            </style></div>
        <!--表格主体 END-->
        <script type="text/javascript">
            $("button[data-type='search']").click(function(){
                var userid = $("input[data-userid='userid']").val();
                var date = $("input[data-date='date']").val();
                location.href="{:url('ffadmin/money/txlist')}?userid=" + userid + "&&date="+date;
            });

            $("button[data-type='clear']").click(function(){
                location.href="{:url('ffadmin/money/txlist')}";
            });
        </script>
        <!--右侧固定栏 BEGIN-->
        <script type="text/html" id="barDemo">
            <a class="layui-btn layui-btn-xs" lay-event="edit" onclick='passcashout("{{d.u_id}}");' >审核通过</a>
        </script>
        <!--右侧固定栏 END-->

        <script type="text/html" id="switchTpl">
            <span style="pointer-events: auto; cursor: pointer;" class="label {{ d.u_is_frozen == 0 ? 'label-success' : 'label-danger' }} label-mini" onclick="enable('{{d.u_id}}');">{{ d.u_is_frozen == 0 ? '激活' : '冻结' }}</span>
        </script>

        <script type="text/html" id="type">

            <a href="#myModal1" data-toggle="modal"  onclick='change("{{d.u_id}}");'>
                {{d.u_type}}
            </a>

            <!--<a href="#" ></a>-->
        </script>


        <script type="text/html" id="level">

            <a href="#myModal1" data-toggle="modal"  onclick='change("{{d.u_id}}");'>
                {{d.u_level}}
            </a>

            <!--<a href="#" ></a>-->
        </script>


        <!--表格自定义按钮 BEGIN-->
        <script type="text/html" id="toolbarDemo">
            <div class="layui-btn-container">
                <a href="#myModal" data-toggle="modal" class="layui-btn layui-btn-sm" onclick="add();">
                    添加用户
                </a>
            </div>
        </script>
        <!--表格自定义按钮 END-->

    </section>
</section>

<script>
    queren = function(id){
        layer.confirm('是否确认提现?', {icon: 3, title:'提示'}, function(index){
            var load = layer.load();
            $.ajax({
                url:"{:url('ffadmin/money/editstatus')}",
                type:'post',
                data:{id:id,type:1},
                dataType:'json',
                success:function(res){
                    console.log(res);
                    if(res.con==1){
                        layer.close(load);
                        layer.msg(res.message,function(){
                            window.location.reload();
                        });
                    }else{
                        layer.close(load);
                        layer.msg(res.message,function(){
                            window.location.reload();
                        });
                    }
                }
            })
            layer.close(index);
        });
    }

    bohui = function(id){
        layer.confirm('是否驳回提现?', {icon: 3, title:'提示'}, function(index){
            var load = layer.load();
            $.ajax({
                url:"{:url('ffadmin/money/editstatus')}",
                type:'post',
                data:{id:id,type:2},
                dataType:'json',
                success:function(res){
                    console.log(res);
                    if(res.con==1){
                        layer.close(load);
                        layer.msg(res.message,function(){
                            window.location.reload();
                        });
                    }else{
                        layer.close(load);
                        layer.msg(res.message,function(){
                            window.location.reload();
                        });
                    }
                }
            })
            layer.close(index);
        });
    }

    $("#all").click(function(){
        var userids = this.checked;
        $("input[name=ids]").each(function() {
            this.checked = userids;
        });
    })

    piliang = function(){
        str = "";
        $('input[name=ids]').each(function() {
            if (this.checked == true) {
                str += $(this).data("id") + ",";
            }
        });
        if (str == "") {
            layer.msg('请选中要批量确定的');
            return false;
        }
        str = str.substring(0, str.length - 1);
        layer.confirm('确定通过这些么?', { btn: ['确定', '取消'] },
            function() {
                var load = layer.load();
                $.ajax({
                    type: 'post',
                    data: { id: str,type:1 },
                    datatype: "json",
                    url: "{:url('ffadmin/money/txlist')}",
                    success: function(res) {
                        if (res.con == 1) {
                            layer.close(load);
                            layer.msg(res.message);
                            window.location.reload();
                        } else if (res.con == 0) {
                            layer.close(load);
                            layer.msg(res.message);
                        }
                    }
                });
                str = "";
            },
            function() {
                str = "";
            });
    }
    piliangbo = function(){
        str = "";
        $('input[name=ids]').each(function() {
            if (this.checked == true) {
                str += $(this).data("id") + ",";
            }
        });
        if (str == "") {
            layer.msg('请选中要批量驳回的');
            return false;
        }
        str = str.substring(0, str.length - 1);
        layer.confirm('确定驳回这些么?', { btn: ['确定', '取消'] },
            function() {
                var load = layer.load();
                $.ajax({
                    type: 'post',
                    data: { id: str,type:2 },
                    datatype: "json",
                    url: "{:url('xdsffsgdbadmin/receive/piliangtixian')}",
                    success: function(res) {
                        if (res.con == 1) {
                            layer.close(load);
                            layer.msg(res.message);
                            window.location.reload();
                        } else if (res.con == 0) {
                            layer.close(load);
                            layer.msg(res.message);
                        }
                    }
                });
                str = "";
            },
            function() {
                str = "";
            });
    }
</script>
<script>
    layui.use('laydate', function(){
        var laydate = layui.laydate;


        //日期范围
        laydate.render({
            elem: '#testaa'
            ,range: true
        });

    });
</script>
<script type="text/javascript" src="js/table.js"></script>


</section>

{/block}